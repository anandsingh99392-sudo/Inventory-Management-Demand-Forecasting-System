import pandas as pd
import glob
import os

files = [
    "Inventory Segregation - Based on price.xlsx - Unit Price more than 100K.csv",
    "Inventory Segregation - Based on price.xlsx - Cumulative price more than 100K.csv",
    "Inventory Segregation - Based on price.xlsx - Unit Price more-50K to 100K.csv",
    "Inventory Segregation - Based on price.xlsx - Cumulative price-50K to 100K.csv"
]

dfs = []
for f in files:
    # Read file, skipping the first row if it's empty/metadata based on snippets
    # The snippet shows ,,,,,,,,,,, as the first line and then the header.
    df = pd.read_csv(f, header=1)
    # Remove unnamed columns if any (due to leading/trailing commas)
    df = df.loc[:, ~df.columns.str.contains('^Unnamed')]
    dfs.append(df)
    print(f"File: {f}")
    print(df.columns.tolist())
    print(df.head(2))
    print("-" * 30)


Code output
File: Inventory Segregation - Based on price.xlsx - Unit Price more than 100K.csv
['S.No', 'Item Code', 'Item Description', 'UOM', 'Received Qty', 'Issue Qty', 'Stock InHand', 'Unit Price (INR)', 'Inventory(INR)', 'Machine', 'Inward date']
   S.No                  Item Code      Item Description  UOM  Received Qty  Issue Qty  Stock InHand  Unit Price (INR)  Inventory(INR) Machine  Inward date
0   1.0  203RPM-IMPELLERMTR55KW001  55 kw impeller motor  nos           2.0        0.0           2.0            552750         1105500     PTL  Before 2017
1   2.0  203RPM-GEARDMOTOR11KW0001    11 kw geared motor  nos           1.0        0.0           1.0            261300          261300     PTL  Before 2017
------------------------------
File: Inventory Segregation - Based on price.xlsx - Cumulative price more than 100K.csv
['S.No.', 'Item Code', 'Item Description', 'UOM', 'Received Qty', 'Issue Qty', 'Stock InHand', 'Unit Price (INR)', 'Inventory(INR)', 'Machine', 'Inward date']
   S.No.                  Item Code     Item Description  UOM  Received Qty  Issue Qty  Stock InHand  Unit Price (INR)  Inventory(INR) Machine  Inward date
0    1.0  203RPM-ROLLERLINERCOVER01   roller liner cover  nos          26.0        0.0          26.0           42210.0       1097460.0    PTL   Before 2017
1    2.0  203RPM-IMPELLERSIDELINER1  Impeller Side liner  nos          14.0        0.0          14.0           20100.0        281400.0    PTL   Before 2017
------------------------------
File: Inventory Segregation - Based on price.xlsx - Unit Price more-50K to 100K.csv
['S.No', 'Item Code', 'Item Description', 'UOM', 'Received Qty', 'Issue Qty', 'Stock InHand', 'Unit Price (INR)', 'Inventory(INR)', 'Machine', 'Inward date']
   S.No                  Item Code                Item Description  UOM  Received Qty  Issue Qty  Stock InHand  Unit Price (INR)  Inventory(INR)      Machine  Inward date
0   1.0  203RPM-SOLENOIDCOIL4B3DCV       Solenoid coil for 4/3 DCV  nos           2.0        0.0           2.0           95810.0        191620.0  Transporter  Before 2017
1   2.0  203RPM-CBLREELDRUM4SLPRNG  Cable Reeling Drum with 4 Slip  nos           2.0        1.0           1.0           95000.0         95000.0        Crane   16.07.2019
------------------------------
File: Inventory Segregation - Based on price.xlsx - Cumulative price-50K to 100K.csv
['S.No.', 'Item Code', 'Item Description', 'UOM', 'Received Qty', 'Issue Qty', 'Stock InHand', 'Unit Price (INR)', 'Inventory(INR)', 'Machine', 'Inward date']
   S.No.                  Item Code                Item Description  UOM  Received Qty  Issue Qty  Stock InHand  Unit Price (INR)  Inventory(INR)          Machine  Inward date
0    1.0  203RPM-PCB407099100000001                     4070991 PCB  nos           5.0        2.0           3.0           33150.0         99450.0  Welding machine  Before 2017
1    2.0  203RPM-QCKDISCNCTRECEPTCL  quick disconnect recepticle;22  nos           2.0        0.0           2.0           47535.5         95071.0           Messer   06.07.2018
------------------------------

Python

# Standardizing the columns and merging
standard_dfs = []
for df in dfs:
    # Rename columns based on mapping
    # Note: Using .get() because some use 'S.No' and others 'S.No.' but the rest seem identical
    mapping = {
        'Item Code': 'item_code',
        'Item Description': 'item_description',
        'Received Qty': 'received_quantity',
        'Issue Qty': 'issued_quantity',
        'Stock InHand': 'stock_onhand',
        'Unit Price (INR)': 'unit_cost',
        'Machine': 'equipment_name',
        'Inward date': 'date_received'
    }
    df_renamed = df.rename(columns=mapping)
    # Keep only relevant columns
    cols_to_keep = list(mapping.values())
    df_filtered = df_renamed[cols_to_keep].copy()
    standard_dfs.append(df_filtered)

# Concatenate all dataframes
final_df = pd.concat(standard_dfs, ignore_index=True)

# Clean date column
def clean_date(val):
    val = str(val).strip()
    if 'Before 2017' in val:
        return '2016-12-31'
    if '&' in val: # Handle cases like '10.09.2019 & 02.01.2019'
        return val.split('&')[0].strip()
    return val

final_df['date_received'] = final_df['date_received'].apply(clean_date)
final_df['date_received'] = pd.to_datetime(final_df['date_received'], dayfirst=True, errors='coerce')

# Fill missing/placeholder columns
final_df['issued_date'] = final_df['date_received'] # Approximating issue date as inward date for lack of specific data
final_df['item_PR_number'] = 'PR-UNKNOWN'
final_df['item_PO_number'] = 'PO-UNKNOWN'

# Drop rows with all NaN (if any)
final_df = final_df.dropna(subset=['item_code'])

# Sort by date
final_df = final_df.sort_values(by='date_received')

# Save to CSV
output_filename = 'inventory_data.csv'
final_df.to_csv(output_filename, index=False)

print(f"Data processed. Total records: {len(final_df)}")
print(final_df.head())
